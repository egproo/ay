# توثيق شاشة طلبات البيع (Order)

---

## 1. وصف الشاشة
شاشة إدارة طلبات البيع تتيح إنشاء وتعديل وعرض وطباعة وتتبع الطلبات من الإنشاء حتى التسليم، مع دعم وحدات المنتجات، التسعير المتدرج، الضرائب، الشحن، الربط بالمخزون والمحاسبة، ودعم الموافقات الذكية والتقسيط.

---

## 2. الجداول المرتبطة

### جدول رئيسي: `cod_order`
| الحقل                | النوع           | الوصف                        |
|----------------------|-----------------|------------------------------|
| order_id             | int             | رقم الطلب (مفتاح أساسي)      |
| journal_id           | int             | رقم القيد المحاسبي            |
| invoice_no           | int             | رقم الفاتورة                  |
| invoice_prefix       | varchar(26)     | بادئة الفاتورة                |
| store_id             | int             | رقم المتجر                    |
| store_name           | varchar(64)     | اسم المتجر                    |
| store_url            | varchar(255)    | رابط المتجر                   |
| customer_id          | int             | رقم العميل (FK)               |
| customer_group_id    | int             | مجموعة العميل                 |
| firstname            | varchar(255)    | اسم العميل                    |
| lastname             | varchar(32)     | اسم العائلة                   |
| email                | varchar(96)     | البريد الإلكتروني             |
| telephone            | varchar(32)     | الهاتف                        |
| ...                  | ...             | ... (تفاصيل الدفع والشحن)     |
| total                | decimal(15,4)   | إجمالي الطلب                  |
| order_status_id      | int             | حالة الطلب (FK)               |
| affiliate_id         | int             | رقم الشريك التسويقي           |
| commission           | decimal(15,4)   | العمولة                       |
| marketing_id         | int             | رقم الحملة التسويقية          |
| tracking             | varchar(64)     | كود التتبع                    |
| language_id          | int             | اللغة                         |
| currency_id          | int             | العملة                        |
| currency_code        | varchar(3)      | كود العملة                    |
| date_added           | datetime        | تاريخ الإنشاء                 |
| date_modified        | datetime        | تاريخ التعديل                 |
| ...                  | ...             | ... (حقول متقدمة أخرى)        |

### جدول العناصر: `cod_order_product`
| الحقل             | النوع           | الوصف                        |
|-------------------|-----------------|------------------------------|
| order_product_id  | int             | رقم العنصر (مفتاح أساسي)     |
| order_id          | int             | رقم الطلب (FK)               |
| product_id        | int             | رقم المنتج (FK)               |
| unit_id           | int             | رقم الوحدة (FK)               |
| name              | varchar(255)    | اسم المنتج                    |
| model             | varchar(64)     | موديل المنتج                  |
| quantity          | int             | الكمية                        |
| price             | decimal(15,4)   | السعر                         |
| total             | decimal(15,4)   | الإجمالي                      |
| tax               | decimal(15,4)   | الضريبة                       |
| reward            | int             | نقاط المكافأة                 |

### جداول مساعدة ومشتركة:
- cod_order_option (خيارات المنتجات)
- cod_order_history (تاريخ الحالة)
- cod_order_status (حالات الطلب)
- cod_order_total (تفاصيل الإجماليات)
- cod_order_shipment (الشحن)
- cod_order_shipment_history (تتبع الشحن)
- cod_order_voucher (قسائم الشراء)
- cod_paymentlinks (روابط الدفع)
- cod_customer (العملاء)
- cod_user (المستخدمون)
- cod_product (المنتجات)
- cod_unit (الوحدات)
- cod_activity_log (سجل الأنشطة)
- cod_notification (الإشعارات)
- cod_message (الرسائل)
- cod_workflow_instance (سير العمل)

---

## 3. العلاقات والاعتماديات
- كل طلب مرتبط بعميل، متجر، حالة، موظف منشئ.
- كل عنصر طلب مرتبط بمنتج ووحدة وخيارات.
- الطلب مرتبط بالشحن، الفواتير، المدفوعات، المخزون، المحاسبة.
- دعم متكامل للإشعارات وسير العمل (workflow, approval).
- دعم متكامل للتقسيط والعروض الترويجية.

---

## 4. العيوب الحالية
- بعض العمليات ما زالت تعتمد على منطق OpenCart التقليدي (يمكن تحسينها).
- واجهة المستخدم جيدة لكن يمكن تطويرها لتكون أسرع وأكثر تفاعلية.
- سير العمل والموافقات بحاجة لتطوير وربط أعمق.
- يمكن تحسين التكامل مع مركز الإشعارات والتواصل الداخلي.
- دعم التقسيط والعروض بحاجة لتوسعة.

---

## 5. خطة التحسين للوصول لمستوى عالمي
- تحسين واجهة المستخدم لتكون أسرع وأكثر تفاعلية (SPA/React/Vue).
- تطوير سير العمل والموافقات الذكية (workflow, multi-level approval).
- ربط متكامل مع مركز الإشعارات والتواصل الداخلي.
- دعم كامل للتقسيط والعروض الترويجية.
- تحسين التكامل مع المحاسبة والمخزون والشحن.
- توثيق كل الحقول والعلاقات في هذا الملف وتحديثه باستمرار. 