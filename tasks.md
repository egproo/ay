# قائمة المهام للإصلاح والاستكمال

## المرحلة 1: تحسينات حرجة (1-2 أسابيع)

### 1. تحسين تكامل المخزون مع المحاسبة
- [ ] إصلاح آلية حساب المتوسط المرجح للتكلفة
  - تعديل دالة `calculateWeightedAverageCost` في `model/catalog/product.php`
  - إضافة اختبارات للتأكد من دقة الحسابات
  - معالجة حالات الخطأ والقيم السالبة
- [ ] توحيد استدعاء دوال المحاسبة
  - إنشاء طبقة وسيطة للتكامل بين المخزون والمحاسبة
  - توحيد واجهة برمجة التطبيقات (API) للتكامل
  - تعديل جميع نقاط الاستدعاء لاستخدام الطبقة الوسيطة
- [ ] إضافة معرف موحد يربط بين حركة المخزون والقيود المحاسبية
  - تعديل جداول قاعدة البيانات لإضافة حقول الربط
  - تعديل الدوال لاستخدام المعرف الموحد
  - إضافة وظائف للتتبع والاستعلام باستخدام المعرف

### 2. تحسين أداء قاعدة البيانات
- [ ] تحسين الاستعلامات
  - مراجعة وتحسين الاستعلامات في نماذج المخزون والمحاسبة
  - استخدام الاستعلامات المجمعة بدلاً من الاستعلامات المتكررة
  - تقليل عدد الاستعلامات في العمليات الشائعة
- [ ] إضافة الفهارس المناسبة
  - تحليل الاستعلامات الأكثر استخداماً وإضافة فهارس لها
  - إضافة فهارس مركبة للاستعلامات المعقدة
  - إزالة الفهارس غير المستخدمة
- [ ] تنظيف البيانات غير الضرورية
  - إضافة آلية لأرشفة البيانات القديمة
  - إضافة آلية لحذف البيانات المؤقتة
  - تحسين هيكل الجداول لتقليل التكرار

### 3. إصلاح مشاكل ترحيل القيود المحاسبية
- [ ] تحسين أداء ترحيل القيود
  - تعديل دالة `postJournalEntries` في `model/accounts/journal.php`
  - استخدام المعالجة المتوازية للقيود الكثيرة
  - تقسيم عملية الترحيل إلى مجموعات صغيرة
- [ ] إضافة آلية للتراجع عن الترحيل
  - تصميم وتنفيذ آلية آمنة للتراجع عن الترحيل
  - إضافة سجل للتراجع عن الترحيل
  - إضافة صلاحيات للتراجع عن الترحيل
- [ ] تحسين واجهة المستخدم لترحيل القيود
  - إضافة مؤشر تقدم لعملية الترحيل
  - تحسين رسائل الخطأ والنجاح
  - إضافة خيارات تصفية وتحديد للقيود

## المرحلة 2: تحسينات مهمة (2-4 أسابيع)

### 1. تحسين تكامل المبيعات والمشتريات مع المحاسبة
- [ ] توحيد آلية إنشاء القيود المحاسبية
  - إنشاء طبقة وسيطة للتكامل بين المبيعات والمشتريات والمحاسبة
  - توحيد واجهة برمجة التطبيقات (API) للتكامل
  - تعديل جميع نقاط الاستدعاء لاستخدام الطبقة الوسيطة
- [ ] إصلاح مشاكل معالجة الضرائب والخصومات
  - تعديل دوال حساب الضرائب والخصومات
  - توحيد آلية معالجة الضرائب والخصومات
  - إضافة اختبارات للتأكد من دقة الحسابات
- [ ] تحسين ربط المدفوعات والتحصيلات بالفواتير
  - تعديل واجهة المستخدم لتسهيل ربط المدفوعات والتحصيلات بالفواتير
  - إضافة دعم لسداد فواتير متعددة بدفعة واحدة
  - تحسين آلية تتبع المدفوعات الجزئية

### 2. تحسين نظام التدقيق
- [ ] ضمان تسجيل جميع العمليات
  - تحديد جميع نقاط التسجيل في النظام
  - إضافة تسجيل للعمليات غير المسجلة
  - توحيد آلية التسجيل عبر النظام
- [ ] تحسين أداء سجلات التدقيق
  - تحسين استعلامات سجلات التدقيق
  - إضافة فهارس مناسبة لجداول السجلات
  - إضافة آلية لأرشفة السجلات القديمة
- [ ] إضافة المزيد من التفاصيل في سجلات التدقيق
  - تسجيل القيم القديمة والجديدة في التغييرات
  - تسجيل معلومات إضافية عن المستخدم والجلسة
  - إضافة تصنيف للعمليات المسجلة

### 3. توحيد وتنظيم هيكل المشروع
- [ ] دمج مجلدي `accounting` و `accounts`
  - تحليل الوظائف في كلا المجلدين
  - نقل الوظائف المتشابهة إلى مجلد واحد
  - تحديث جميع الاستدعاءات والمراجع
- [ ] توحيد تسمية الملفات والدوال
  - وضع معايير موحدة لتسمية الملفات والدوال
  - تعديل أسماء الملفات والدوال لتتوافق مع المعايير
  - توثيق المعايير للاستخدام المستقبلي
- [ ] إزالة الملفات المكررة وغير المستخدمة
  - تحديد الملفات المكررة وغير المستخدمة
  - نقل الوظائف المفيدة من الملفات المكررة
  - إزالة الملفات غير الضرورية

## المرحلة 3: تحسينات إضافية (4-6 أسابيع)

### 1. تحسين واجهة المستخدم
- [ ] جعلها أكثر بداهة واتساقاً
  - توحيد تصميم الواجهات عبر النظام
  - تحسين تنظيم العناصر في الشاشات المعقدة
  - إضافة تلميحات ومساعدة للمستخدم
- [ ] تحسين تجربة المستخدم في الأقسام المعقدة
  - تبسيط سير العمل في الأقسام المعقدة
  - إضافة معالجات (wizards) للعمليات المعقدة
  - تحسين التنقل بين الشاشات المترابطة
- [ ] إضافة المزيد من التخصيص
  - إضافة خيارات لتخصيص الشاشات والتقارير
  - إضافة إمكانية حفظ التفضيلات للمستخدم
  - إضافة لوحات معلومات قابلة للتخصيص

### 2. تحسين نظام الإشعارات
- [ ] توحيد استدعاء نظام الإشعارات
  - إنشاء واجهة برمجة تطبيقات (API) موحدة للإشعارات
  - تعديل جميع نقاط الاستدعاء لاستخدام الواجهة الموحدة
  - إضافة فئات وأولويات للإشعارات
- [ ] إضافة إعدادات لتفضيلات الإشعارات
  - إضافة شاشة لإدارة تفضيلات الإشعارات
  - إضافة خيارات للإشعارات حسب النوع والأولوية
  - إضافة دعم للإشعارات عبر البريد الإلكتروني
- [ ] تحسين عرض الإشعارات
  - تحسين تصميم مركز الإشعارات
  - إضافة تصفية وتجميع للإشعارات
  - إضافة إمكانية تمييز الإشعارات كمقروءة/غير مقروءة

### 3. استكمال الوحدات غير المكتملة
- [ ] استكمال نظام المستندات
  - استكمال واجهة المستخدم لإدارة المستندات
  - إضافة دعم لأنواع مختلفة من المستندات
  - إضافة إمكانية البحث في محتوى المستندات
- [ ] استكمال محرر سير العمل
  - استكمال واجهة المستخدم لمحرر سير العمل
  - إضافة المزيد من العناصر والإجراءات
  - إضافة إمكانية تشغيل سير العمل تلقائياً
- [ ] استكمال نظام التواصل الداخلي
  - استكمال واجهة المستخدم للتواصل الداخلي
  - إضافة دعم للمحادثات الجماعية
  - إضافة إمكانية مشاركة الملفات والروابط

## المرحلة 4: مراجعة وتوثيق (2-3 أسابيع)

### 1. اختبار شامل للنظام
- [ ] إعداد خطة اختبار شاملة
  - تحديد حالات الاختبار لجميع الوظائف
  - إعداد بيانات اختبار واقعية
  - تحديد معايير النجاح والفشل
- [ ] تنفيذ الاختبارات
  - اختبار الوظائف الأساسية
  - اختبار التكامل بين الوحدات
  - اختبار الأداء والتحمل
- [ ] توثيق نتائج الاختبارات
  - توثيق الأخطاء والمشاكل
  - توثيق الحلول والتحسينات
  - إعداد تقرير نهائي للاختبارات

### 2. إصلاح الأخطاء المتبقية
- [ ] تحديد وتصنيف الأخطاء المتبقية
  - تصنيف الأخطاء حسب الخطورة والأولوية
  - تحديد الأخطاء التي تحتاج إلى إصلاح فوري
  - تحديد الأخطاء التي يمكن تأجيلها
- [ ] إصلاح الأخطاء ذات الأولوية العالية
  - إصلاح الأخطاء التي تؤثر على وظائف أساسية
  - إصلاح الأخطاء التي تؤثر على دقة البيانات
  - إصلاح الأخطاء التي تؤثر على أمان النظام
- [ ] إعداد خطة لإصلاح الأخطاء المتبقية
  - تحديد الموارد والوقت اللازم
  - تحديد الأولويات والجدول الزمني
  - تحديد المسؤوليات والمهام

### 3. توثيق النظام
- [ ] إعداد دليل المستخدم
  - توثيق جميع الوظائف والشاشات
  - إضافة أمثلة وحالات استخدام
  - إضافة صور توضيحية
- [ ] إعداد دليل المطور
  - توثيق هيكل المشروع وقاعدة البيانات
  - توثيق واجهات برمجة التطبيقات (APIs)
  - توثيق آليات التكامل والتوسعة
- [ ] إعداد دليل الإدارة
  - توثيق إعدادات النظام
  - توثيق إجراءات الصيانة والنسخ الاحتياطي
  - توثيق إجراءات الأمان والتدقيق

### 4. تدريب المستخدمين
- [ ] إعداد خطة تدريب
  - تحديد احتياجات التدريب لمختلف المستخدمين
  - إعداد مواد التدريب
  - تحديد الجدول الزمني للتدريب
- [ ] تنفيذ التدريب
  - تدريب المستخدمين على الوظائف الأساسية
  - تدريب المديرين على التقارير والتحليلات
  - تدريب المسؤولين على إدارة النظام
- [ ] تقييم ومتابعة التدريب
  - تقييم فعالية التدريب
  - تحديد احتياجات التدريب الإضافية
  - إعداد خطة للدعم المستمر
